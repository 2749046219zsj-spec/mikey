# 竞品图库上传助手 - 浏览器扩展插件

一个简单高效的浏览器扩展，允许用户通过右键菜单快速将网页图片上传到竞品图库系统。

## 功能特性

- ✅ 右键菜单快速上传图片
- ✅ 自动提取图片元数据（尺寸、alt、title等）
- ✅ 智能识别商品信息（支持SHEIN、淘宝、亚马逊等网站）
- ✅ 上传进度和结果通知
- ✅ 统计上传数据
- ✅ 简洁的配置界面
- ✅ 支持Chrome和Firefox浏览器

## 安装方法

### Chrome浏览器

1. **下载插件文件**
   - 下载整个 `browser-extension` 文件夹

2. **打开Chrome扩展管理页面**
   - 在Chrome地址栏输入: `chrome://extensions/`
   - 或者点击右上角菜单 → 更多工具 → 扩展程序

3. **启用开发者模式**
   - 在页面右上角打开"开发者模式"开关

4. **加载扩展**
   - 点击"加载已解压的扩展程序"
   - 选择 `browser-extension` 文件夹
   - 插件图标将出现在浏览器工具栏

### Firefox浏览器

1. **下载插件文件**
   - 下载整个 `browser-extension` 文件夹

2. **临时安装**
   - 在Firefox地址栏输入: `about:debugging#/runtime/this-firefox`
   - 点击"临时载入附加组件"
   - 选择 `browser-extension` 文件夹中的 `manifest.json` 文件

3. **永久安装**
   - 需要将插件打包为 `.xpi` 文件并签名
   - 或在Firefox开发者版本中使用

## 配置说明

### 第一步：配置API地址

1. **点击插件图标**打开配置面板

2. **输入API上传地址**
   - 使用你的Supabase Edge Function URL
   - 格式：`https://your-project.supabase.co/functions/v1/competitor-image-upload`
   - 替换 `your-project` 为你的实际项目ID

3. **查看你的项目URL**
   ```bash
   # 在项目根目录查看 .env 文件
   VITE_SUPABASE_URL=https://your-project.supabase.co
   ```

   完整的API地址为：
   ```
   https://your-project.supabase.co/functions/v1/competitor-image-upload
   ```

4. **测试连接**
   - 点击"测试连接"按钮验证配置是否正确
   - 看到"连接成功"提示即可使用

5. **保存配置**
   - 点击"保存配置"按钮

### 第二步：确保启用功能

- 确保"启用上传功能"开关处于开启状态

## 使用方法

### 基本使用

1. **浏览网页**
   - 访问任意包含图片的网页（如SHEIN、淘宝、京东等）

2. **右键点击图片**
   - 在需要保存的图片上点击鼠标右键

3. **选择上传**
   - 在右键菜单中选择"上传到竞品图库"

4. **等待完成**
   - 系统会显示"上传中"通知
   - 上传成功后会显示"上传成功"通知

### 查看统计

- 点击插件图标查看上传统计
- 显示总上传数和最后上传时间

## 技术架构

### 文件结构

```
browser-extension/
├── manifest.json          # 插件配置文件（Manifest V3）
├── background.js          # 后台脚本（处理上传逻辑）
├── content.js            # 内容脚本（提取页面信息）
├── popup.html            # 弹窗界面HTML
├── popup.js              # 弹窗界面逻辑
├── popup.css             # 弹窗界面样式
├── icons/                # 插件图标文件夹
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md             # 说明文档
```

### 数据流程

1. **用户右键点击图片** → 触发右键菜单
2. **background.js** → 接收菜单点击事件
3. **content.js** → 提取图片信息和页面上下文
4. **background.js** → 下载图片并上传到API
5. **Edge Function** → 接收图片并保存到Supabase Storage
6. **数据库** → 保存图片记录到 `public_reference_images` 表
7. **通知用户** → 显示上传结果

### 支持的图片格式

- JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)
- WebP (.webp)
- BMP (.bmp)
- SVG (.svg)

### 提取的元数据

插件会自动提取以下信息：

- **图片信息**：URL、尺寸、alt文本、title属性
- **页面信息**：页面URL、页面标题
- **商品信息**（如果可识别）：
  - 商品名称
  - 商品价格
  - 商品描述

## 安全说明

### 权限说明

插件请求的权限：

- `contextMenus`: 创建右键菜单
- `storage`: 保存配置和统计数据
- `notifications`: 显示上传通知
- `<all_urls>`: 访问所有网页（用于获取图片）

### 隐私保护

- 插件不会收集任何个人信息
- 所有数据存储在你自己的Supabase数据库
- 图片上传到你的Supabase Storage
- 配置信息仅保存在本地浏览器

### 安全建议

1. 不要与他人共享你的API地址
2. 定期检查上传的图片内容
3. 使用HTTPS连接确保传输安全
4. 仅在可信网站上使用

## 故障排除

### 上传失败

**问题：点击上传后显示"上传失败"**

解决方法：
1. 检查API地址是否正确配置
2. 确认Supabase项目是否正常运行
3. 检查浏览器控制台错误信息
4. 尝试测试连接功能

### 无法获取图片

**问题：某些图片无法上传**

可能原因：
1. 图片使用了防盗链保护
2. 图片需要登录才能访问
3. 跨域限制（CORS）

解决方法：
- 在开发者工具中查看网络请求
- 检查图片URL是否可以直接访问

### 插件图标不显示

**问题：安装后工具栏没有图标**

解决方法：
1. 确保 `icons` 文件夹包含图标文件
2. 重新加载扩展程序
3. 检查manifest.json配置是否正确

### 配置无法保存

**问题：保存配置后重新打开丢失**

解决方法：
1. 检查浏览器的storage权限
2. 清除浏览器缓存后重试
3. 重新安装插件

## 开发指南

### 本地开发

1. **修改代码**
   - 直接编辑插件文件

2. **重新加载**
   - 在Chrome扩展管理页面点击"重新加载"按钮
   - 或使用快捷键 `Ctrl+R`（在扩展管理页面）

3. **调试**
   - 右键点击插件图标 → "检查弹出内容"
   - 或在扩展管理页面点击"背景页"

### 打包发布

**Chrome Web Store:**

```bash
# 压缩为zip文件
cd browser-extension
zip -r extension.zip *
```

**Firefox Add-ons:**

```bash
# 使用web-ext工具打包
npm install -g web-ext
cd browser-extension
web-ext build
```

## 与主应用集成

上传的图片会自动保存到Supabase的 `public_reference_images` 表，可以在主应用的"参考图库"中查看和管理。

### 查看上传的图片

1. 登录主应用
2. 进入"参考图库"页面
3. 切换到"公共数据库"标签
4. 查看带有"浏览器上传"标签的图片

### 图片分类

- 自动分类为 `competitor`（竞品）类别
- 自动添加 `竞品`、`浏览器上传` 标签
- 包含完整的元数据信息

## 更新日志

### v1.0.0 (2025-10-26)

- ✅ 初始版本发布
- ✅ 支持右键菜单上传图片
- ✅ 集成Supabase存储
- ✅ 智能提取商品信息
- ✅ 支持多种电商网站
- ✅ 完整的错误处理和通知

## 技术支持

### 常见问题

查看上方"故障排除"部分

### 获取帮助

1. 查看浏览器控制台错误信息
2. 检查Supabase Edge Function日志
3. 确认网络连接正常

## 许可证

本项目为内部工具，仅供授权用户使用。

## 注意事项

1. **合法使用**：仅用于收集竞品参考，不得用于侵权目的
2. **尊重版权**：上传的图片仅供内部参考，不得用于商业用途
3. **网站政策**：遵守各网站的服务条款和robots.txt规则
4. **存储空间**：注意Supabase存储配额限制

---

**祝使用愉快！**
